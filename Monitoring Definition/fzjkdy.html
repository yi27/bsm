<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script type="text/javascript" src="http://netdna.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <link href="../styles/blue-theme.css" rel="stylesheet" type="text/css">
    <link href="../styles/bootstrap.css" rel="stylesheet" type="text/css">
    <link href="../styles/style.css" rel="stylesheet" type="text/css">
    <style>
@font-face {
  font-family: 'Glyphicons Halflings';
  src: url('../fonts/glyphicons-halflings-regular.eot');
  src: url('../fonts/glyphicons-halflings-regular.eot?#iefix') format('embedded-opentype'), url('../fonts/glyphicons-halflings-regular.woff') format('woff'), url('../fonts/glyphicons-halflings-regular.ttf') format('truetype'), url('../fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular') format('svg');
}
.glyphicon {
  position: relative;
  top: 1px;
  display: inline-block;
  font-family: 'Glyphicons Halflings';
  -webkit-font-smoothing: antialiased;
  font-style: normal;
  font-weight: normal;
  line-height: 1;
  -moz-osx-font-smoothing: grayscale;
}
</style>
  </head><body class="all-bg">
    <div class="">
      <div class="container">
        <div class="col-md-12">     <h2 class="small-h2">负载监控定义</h2>


          <div class="">
            <form class="form-search" method="post" action="./fzjhzdy.php">
              <div class="col-md-2">
                <input class="input-medium search-query form-control" style="width:92%"  value="<?php echo $groupid;?>" name="groupid" placeholder="组ID" type="text">
              </div>
                 <span class="col-md-2">
          <input class="input-medium search-query form-control" style="width:92%"  name="groupname" value="<?php echo $groupname;?>" placeholder="组名称" type="text">
          </span>
              <div class="col-md-2">
			  <?php $select = "selected='selected'";?>
                <select style="width:100%" name="grouptype" class="form-control">
                    <option value="" <?php if(!$grouptype){echo $select;} ?>>组类型</option>
                    <option value="1" <?php if($grouptype==1){echo $select;} ?>>主备</option>
                    <option value="2"<?php if($grouptype==2){echo $select;} ?>>集群</option>
                </select>
              </div>
              <div class="col-md-2">
                <select style="width:100%"  name="lbcount" class="form-control">
                    <option value="3" <?php if($lbcount==3){echo $select;} ?>> 负载均衡器</option>
                    <option value="1" <?php if($lbcount==1){echo $select;} ?>>已有负载均衡器</option>
                    <option value="2" <?php if($lbcount==2){echo $select;} ?>>未有负载均衡器</option>
                </select>
              </div>
                 <span class="col-md-2">
          <select style="width:100%" name="vipcount" class="form-control">
            <option value="3" <?php if($vipcount==3){echo $select;} ?>> 业务服务器</option>
            <option value="1"<?php if($vipcount==1){echo $select;} ?>>已有业务服务器</option>
            <option value="2" <?php if($vipcount==2){echo $select;} ?>>未有业务服务器</option>
          </select>
          </span>
              <div class="col-md-2">
                <button class="btn" contenteditable="true" type="submit" value=""> 搜索</button>
              </div>
            </form>
          </div>
         <div class="col-md-12 space-4"></div>


          <div class="col-md-12">
            <table class="table" style="border:1px solid #ccc" id="Qub_tb_List">
              <thead>
                <tr class="success">
                  <th align="center" class="border-right text-center font-weight"> 选择 </th>
                  <th align="center" class="border-right text-center font-weight"> 主机名称 </th>
                  <th align="center" class="border-right text-center font-weight"> 可见的名称

                    量 </th>
                  <th align="center" class="border-right text-center font-weight">报告邮件接收人 </th>
                  <th align="center" class="border-right text-center font-weight">系统监控量数量 </th>
                  <th align="center" class="border-right text-center font-weight">系统已启用的监控数量 </th>
                  <th align="center" class="border-right text-center font-weight"> 负载监控项数量 </th>
                  <th align="center" class="border-right text-center font-weight"> 负载监控项生效数量</th>
                      <th align="center" class="border-right text-center font-weight"> 最后操作时间</th>
                          <th align="center" class="border-right text-center font-weight"> 最后操作人</th>
                              <th align="center" class="border-right text-center font-weight"> 报告生成次数</th>  <th align="center" class="border-right text-center font-weight"> 最新报告生成时间</th>
                  <th align="center" class=" text-center font-weight">最近巡检时间</th>
                </tr>
              </thead>
              <tbody>
                <?php foreach($data_lbgroup as $key => $value) :?>
                <tr>
                  <td class="border-right text-center"><input class="choicevip form-control" name="choice" placeholder="" type="radio" value="<?php echo $value['groupid']?>"/></td>
                  <td class="border-right text-center"><?php echo $value['groupid']?></td>
                  <td class="border-right text-center"><?php echo $value['groupname']?></td>
                  <td class="border-right text-center"><?php  if($value['grouptype']==1){echo '主备';}elseif($value['grouptype']==2){echo '集群';}?></td>
                  <td class="border-right text-center"><?php echo $value['suptramode']?></td>
                  <td class="border-right text-center"><?php echo $value['lbcount']?></td>
                  <td class="border-right text-center"><?php echo $value['optlasttime']?></td>
                  <td class="border-right text-center"><?php echo $value['optlastname']?></td>
                  <td class="border-right text-center"><?php echo $value['vipcount']?></td>
                    <td class="border-right text-center"><?php echo $value['lbcount']?></td>
                  <td class="border-right text-center"><?php echo $value['optlasttime']?></td>
                  <td class="border-right text-center"><?php echo $value['optlastname']?></td>
                  <td class="border-right text-center"><?php echo $value['vipcount']?></td>
                </tr>
                <?php Endforeach ?>
              </tbody>
            </table>
                   <div class="notice">
          	<p>备注：系统默认每12个小时扫描一次，当服务器的生效的任一负载监控项超出定义值，系统将生成报告并发送指定邮箱。</p>
            <p>当在运维监控中删除主机的监控项,则此处对应的监控项会被设置为失效。</p>
          </div>
          </div>
   
          <div class="col-md-12 text-center">
            <a class="btn btn-primary" target="main" onclick="window.location.href='fzjhzdy-add.php'" >新增</a>
            <a class="btn btn-primary" target="main" id="_edit">修改</a>
            <a class="btn btn-primary" id="_delete">删除</a>
          </div>
        </div>
      </div>
    </div>


</body></html>
<script src="../js/jquery.js" type="text/javascript"></script>
<script>
	$(document).ready(function(){
            var groupid = $("#groupid").val();
            var groupname = $("#groupname").val();
            //var

            if(!groupid){
                  $(this).attr('placeholder','组ID');             //$("#groupid").attr("placeholder",'组ID');
            }else{
                  $(this).val(groupid);
            }

             if(!groupname){
                  $(this).attr('placeholder','组名称');             //$("#groupid").attr("placeholder",'组ID');
            }else{
                  $(this).val(groupname);
            }
    });

    $("#_delete").click(function() {
          if(confirm("该操作将删除关联负载均衡器的配置文件，并停止负载均衡服务！如确认，将在执行队列中待任务发起执行！"))
          {

            var groupid = $(":radio[name=choice]:checked").val();
            $.ajax({
                url: 'fzjhzdy-del.php',
                type: 'POST',
                dataType: 'json',
                data: {param: groupid},

            })
            .done(function(msg) {
              if(msg=="1"){
                alert("该操作不被执行，请先删除关联的业务服务器！");
                 location.replace(location.href);
              }else if(msg=="2"){
                alert("删除成功！");
                 location.replace(location.href);
              }else if(msg=="3"){
                alert('请选择要删除的负载均衡组！！！');
              }
            })


         }
    });

     $("#_edit").click(function() {
      var groupid = $(":radio[name=choice]:checked").val();

      if(!groupid){
        alert("请选择要修改的负载均衡组");
      }else{
        location.href="fzjhzdy-xg.php?groupid="+groupid+"";
      }

  });

      $("#Qub_tb_List").on("click", "tr", function () {
            var input = $(this).find("input");
            //alert($(input).prop("checked"));
            if (!$(input).prop("checked")) {
                $(input).prop("checked",true);
            }else{
              $(input).prop("checked",false);
            }
      });
        //多选框 防止事件冒泡
        $("#Qub_tb_List").on("click", "input", function (event) {
         event.stopImmediatePropagation();
        });

</script>